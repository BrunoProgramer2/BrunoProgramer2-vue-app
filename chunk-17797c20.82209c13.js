(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17797c20"],{"00ee":function(e,t,r){var n=r("b622"),i=n("toStringTag"),s={};s[i]="z",e.exports="[object z]"===String(s)},"06cf":function(e,t,r){var n=r("83ab"),i=r("c65b"),s=r("d1e7"),o=r("5c6c"),a=r("fc6a"),c=r("a04b"),u=r("1a2d"),h=r("0cfb"),l=Object.getOwnPropertyDescriptor;t.f=n?l:function(e,t){if(e=a(e),t=c(t),h)try{return l(e,t)}catch(r){}if(u(e,t))return o(!i(s.f,e,t),e[t])}},"07fa":function(e,t,r){var n=r("50c4");e.exports=function(e){return n(e.length)}},"0cfb":function(e,t,r){var n=r("83ab"),i=r("d039"),s=r("cc12");e.exports=!n&&!i((function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},"0d51":function(e,t){var r=String;e.exports=function(e){try{return r(e)}catch(t){return"Object"}}},1168:function(e,t,r){e.exports=r("ba0c").version},"13d2":function(e,t,r){var n=r("d039"),i=r("1626"),s=r("1a2d"),o=r("83ab"),a=r("5e77").CONFIGURABLE,c=r("8925"),u=r("69f3"),h=u.enforce,l=u.get,d=Object.defineProperty,f=o&&!n((function(){return 8!==d((function(){}),"length",{value:8}).length})),p=String(String).split("String"),v=e.exports=function(e,t,r){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!s(e,"name")||a&&e.name!==t)&&(o?d(e,"name",{value:t,configurable:!0}):e.name=t),f&&r&&s(r,"arity")&&e.length!==r.arity&&d(e,"length",{value:r.arity});try{r&&s(r,"constructor")&&r.constructor?o&&d(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(i){}var n=h(e);return s(n,"source")||(n.source=p.join("string"==typeof t?t:"")),e};Function.prototype.toString=v((function(){return i(this)&&l(this).source||c(this)}),"toString")},1626:function(e,t){e.exports=function(e){return"function"==typeof e}},"1a2d":function(e,t,r){var n=r("e330"),i=r("7b0b"),s=n({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return s(i(e),t)}},"1d80":function(e,t){var r=TypeError;e.exports=function(e){if(void 0==e)throw r("Can't call method on "+e);return e}},"23cb":function(e,t,r){var n=r("5926"),i=Math.max,s=Math.min;e.exports=function(e,t){var r=n(e);return r<0?i(r+t,0):s(r,t)}},"23e7":function(e,t,r){var n=r("da84"),i=r("06cf").f,s=r("9112"),o=r("cb2d"),a=r("6374"),c=r("e893"),u=r("94ca");e.exports=function(e,t){var r,h,l,d,f,p,v=e.target,m=e.global,g=e.stat;if(h=m?n:g?n[v]||a(v,{}):(n[v]||{}).prototype,h)for(l in t){if(f=t[l],e.dontCallGetSet?(p=i(h,l),d=p&&p.value):d=h[l],r=u(m?l:v+(g?".":"#")+l,e.forced),!r&&void 0!==d){if(typeof f==typeof d)continue;c(f,d)}(e.sham||d&&d.sham)&&s(f,"sham",!0),o(h,l,f,e)}}},"241c":function(e,t,r){var n=r("ca84"),i=r("7839"),s=i.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,s)}},"2ba4":function(e,t,r){var n=r("40d5"),i=Function.prototype,s=i.apply,o=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(n?o.bind(s):function(){return o.apply(s,arguments)})},"2d00":function(e,t,r){var n,i,s=r("da84"),o=r("342f"),a=s.process,c=s.Deno,u=a&&a.versions||c&&c.version,h=u&&u.v8;h&&(n=h.split("."),i=n[0]>0&&n[0]<4?1:+(n[0]+n[1])),!i&&o&&(n=o.match(/Edge\/(\d+)/),(!n||n[1]>=74)&&(n=o.match(/Chrome\/(\d+)/),n&&(i=+n[1]))),e.exports=i},"342f":function(e,t,r){var n=r("d066");e.exports=n("navigator","userAgent")||""},"3a9b":function(e,t,r){var n=r("e330");e.exports=n({}.isPrototypeOf)},"3bbe":function(e,t,r){var n=r("1626"),i=String,s=TypeError;e.exports=function(e){if("object"==typeof e||n(e))return e;throw s("Can't set "+i(e)+" as a prototype")}},"40d5":function(e,t,r){var n=r("d039");e.exports=!n((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},"44ad":function(e,t,r){var n=r("e330"),i=r("d039"),s=r("c6b6"),o=Object,a=n("".split);e.exports=i((function(){return!o("z").propertyIsEnumerable(0)}))?function(e){return"String"==s(e)?a(e,""):o(e)}:o},"485a":function(e,t,r){var n=r("c65b"),i=r("1626"),s=r("861d"),o=TypeError;e.exports=function(e,t){var r,a;if("string"===t&&i(r=e.toString)&&!s(a=n(r,e)))return a;if(i(r=e.valueOf)&&!s(a=n(r,e)))return a;if("string"!==t&&i(r=e.toString)&&!s(a=n(r,e)))return a;throw o("Can't convert object to primitive value")}},4930:function(e,t,r){var n=r("2d00"),i=r("d039");e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},"4d64":function(e,t,r){var n=r("fc6a"),i=r("23cb"),s=r("07fa"),o=function(e){return function(t,r,o){var a,c=n(t),u=s(c),h=i(o,u);if(e&&r!=r){while(u>h)if(a=c[h++],a!=a)return!0}else for(;u>h;h++)if((e||h in c)&&c[h]===r)return e||h||0;return!e&&-1}};e.exports={includes:o(!0),indexOf:o(!1)}},"50c4":function(e,t,r){var n=r("5926"),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},5692:function(e,t,r){var n=r("c430"),i=r("c6cd");(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.23.5",mode:n?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.5/LICENSE",source:"https://github.com/zloirock/core-js"})},"56ef":function(e,t,r){var n=r("d066"),i=r("e330"),s=r("241c"),o=r("7418"),a=r("825a"),c=i([].concat);e.exports=n("Reflect","ownKeys")||function(e){var t=s.f(a(e)),r=o.f;return r?c(t,r(e)):t}},"577e":function(e,t,r){var n=r("f5df"),i=String;e.exports=function(e){if("Symbol"===n(e))throw TypeError("Cannot convert a Symbol value to a string");return i(e)}},5926:function(e,t,r){var n=r("b42e");e.exports=function(e){var t=+e;return t!==t||0===t?0:n(t)}},"59ed":function(e,t,r){var n=r("1626"),i=r("0d51"),s=TypeError;e.exports=function(e){if(n(e))return e;throw s(i(e)+" is not a function")}},"5c6c":function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},"5e77":function(e,t,r){var n=r("83ab"),i=r("1a2d"),s=Function.prototype,o=n&&Object.getOwnPropertyDescriptor,a=i(s,"name"),c=a&&"something"===function(){}.name,u=a&&(!n||n&&o(s,"name").configurable);e.exports={EXISTS:a,PROPER:c,CONFIGURABLE:u}},6374:function(e,t,r){var n=r("da84"),i=Object.defineProperty;e.exports=function(e,t){try{i(n,e,{value:t,configurable:!0,writable:!0})}catch(r){n[e]=t}return t}},6787:function(e,t){var r=function(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;if("object"===typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},"69f3":function(e,t,r){var n,i,s,o=r("7f9a"),a=r("da84"),c=r("e330"),u=r("861d"),h=r("9112"),l=r("1a2d"),d=r("c6cd"),f=r("f772"),p=r("d012"),v="Object already initialized",m=a.TypeError,g=a.WeakMap,b=function(e){return s(e)?i(e):n(e,{})},y=function(e){return function(t){var r;if(!u(t)||(r=i(t)).type!==e)throw m("Incompatible receiver, "+e+" required");return r}};if(o||d.state){var _=d.state||(d.state=new g),w=c(_.get),k=c(_.has),S=c(_.set);n=function(e,t){if(k(_,e))throw new m(v);return t.facade=e,S(_,e,t),t},i=function(e){return w(_,e)||{}},s=function(e){return k(_,e)}}else{var T=f("state");p[T]=!0,n=function(e,t){if(l(e,T))throw new m(v);return t.facade=e,h(e,T,t),t},i=function(e){return l(e,T)?e[T]:{}},s=function(e){return l(e,T)}}e.exports={set:n,get:i,has:s,enforce:b,getterFor:y}},7156:function(e,t,r){var n=r("1626"),i=r("861d"),s=r("d2bb");e.exports=function(e,t,r){var o,a;return s&&n(o=t.constructor)&&o!==r&&i(a=o.prototype)&&a!==r.prototype&&s(e,a),e}},7418:function(e,t){t.f=Object.getOwnPropertySymbols},7839:function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(e,t,r){var n=r("1d80"),i=Object;e.exports=function(e){return i(n(e))}},"7e3c":function(e,t,r){var n;if("object"===typeof globalThis)n=globalThis;else try{n=r("6787")}catch(a){}finally{if(n||"undefined"===typeof window||(n=window),!n)throw new Error("Could not determine global this")}var i=n.WebSocket||n.MozWebSocket,s=r("1168");function o(e,t){var r;return r=t?new i(e,t):new i(e),r}i&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(e){Object.defineProperty(o,e,{get:function(){return i[e]}})})),e.exports={w3cwebsocket:i?o:null,version:s}},"7f9a":function(e,t,r){var n=r("da84"),i=r("1626"),s=r("8925"),o=n.WeakMap;e.exports=i(o)&&/native code/.test(s(o))},"825a":function(e,t,r){var n=r("861d"),i=String,s=TypeError;e.exports=function(e){if(n(e))return e;throw s(i(e)+" is not an object")}},"83ab":function(e,t,r){var n=r("d039");e.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},"861d":function(e,t,r){var n=r("1626");e.exports=function(e){return"object"==typeof e?null!==e:n(e)}},8925:function(e,t,r){var n=r("e330"),i=r("1626"),s=r("c6cd"),o=n(Function.toString);i(s.inspectSource)||(s.inspectSource=function(e){return o(e)}),e.exports=s.inspectSource},"90e3":function(e,t,r){var n=r("e330"),i=0,s=Math.random(),o=n(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+o(++i+s,36)}},9112:function(e,t,r){var n=r("83ab"),i=r("9bf2"),s=r("5c6c");e.exports=n?function(e,t,r){return i.f(e,t,s(1,r))}:function(e,t,r){return e[t]=r,e}},"94ca":function(e,t,r){var n=r("d039"),i=r("1626"),s=/#|\.prototype\./,o=function(e,t){var r=c[a(e)];return r==h||r!=u&&(i(t)?n(t):!!t)},a=o.normalize=function(e){return String(e).replace(s,".").toLowerCase()},c=o.data={},u=o.NATIVE="N",h=o.POLYFILL="P";e.exports=o},"9bf2":function(e,t,r){var n=r("83ab"),i=r("0cfb"),s=r("aed9"),o=r("825a"),a=r("a04b"),c=TypeError,u=Object.defineProperty,h=Object.getOwnPropertyDescriptor,l="enumerable",d="configurable",f="writable";t.f=n?s?function(e,t,r){if(o(e),t=a(t),o(r),"function"===typeof e&&"prototype"===t&&"value"in r&&f in r&&!r[f]){var n=h(e,t);n&&n[f]&&(e[t]=r.value,r={configurable:d in r?r[d]:n[d],enumerable:l in r?r[l]:n[l],writable:!1})}return u(e,t,r)}:u:function(e,t,r){if(o(e),t=a(t),o(r),i)try{return u(e,t,r)}catch(n){}if("get"in r||"set"in r)throw c("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},a04b:function(e,t,r){var n=r("c04e"),i=r("d9b5");e.exports=function(e){var t=n(e,"string");return i(t)?t:t+""}},ab36:function(e,t,r){var n=r("861d"),i=r("9112");e.exports=function(e,t){n(t)&&"cause"in t&&i(e,"cause",t.cause)}},aeb0:function(e,t,r){var n=r("9bf2").f;e.exports=function(e,t,r){r in e||n(e,r,{configurable:!0,get:function(){return t[r]},set:function(e){t[r]=e}})}},aed9:function(e,t,r){var n=r("83ab"),i=r("d039");e.exports=n&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},b42e:function(e,t){var r=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var t=+e;return(t>0?n:r)(t)}},b622:function(e,t,r){var n=r("da84"),i=r("5692"),s=r("1a2d"),o=r("90e3"),a=r("4930"),c=r("fdbf"),u=i("wks"),h=n.Symbol,l=h&&h["for"],d=c?h:h&&h.withoutSetter||o;e.exports=function(e){if(!s(u,e)||!a&&"string"!=typeof u[e]){var t="Symbol."+e;a&&s(h,e)?u[e]=h[e]:u[e]=c&&l?l(t):d(t)}return u[e]}},b980:function(e,t,r){var n=r("d039"),i=r("5c6c");e.exports=!n((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",i(1,7)),7!==e.stack)}))},ba0c:function(e){e.exports=JSON.parse('{"name":"websocket","description":"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.","keywords":["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],"author":"Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)","contributors":["Iñaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],"version":"1.0.34","repository":{"type":"git","url":"https://github.com/theturtle32/WebSocket-Node.git"},"homepage":"https://github.com/theturtle32/WebSocket-Node","engines":{"node":">=4.0.0"},"dependencies":{"bufferutil":"^4.0.1","debug":"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2","yaeti":"^0.0.6"},"devDependencies":{"buffer-equal":"^1.0.0","gulp":"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1","jshint":"^2.0.0","tape":"^4.9.1"},"config":{"verbose":false},"scripts":{"test":"tape test/unit/*.js","gulp":"gulp"},"main":"index","directories":{"lib":"./lib"},"browser":"lib/browser.js","license":"Apache-2.0"}')},bb51:function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"PostgresTypes",(function(){return se})),r.d(n,"convertChangeData",(function(){return oe})),r.d(n,"convertColumn",(function(){return ae})),r.d(n,"convertCell",(function(){return ce})),r.d(n,"toBoolean",(function(){return he})),r.d(n,"toNumber",(function(){return le})),r.d(n,"toJson",(function(){return de})),r.d(n,"toArray",(function(){return fe})),r.d(n,"toTimestampString",(function(){return pe}));var i=r("7a23");const s={class:"home"};function o(e,t,r,n,o,a){return Object(i["v"])(),Object(i["f"])("div",s,[Object(i["K"])(Object(i["g"])("input",{type:"email",placeholder:"example@example.com","onUpdate:modelValue":t[0]||(t[0]=t=>e.email=t),onKeyup:t[1]||(t[1]=Object(i["L"])((...t)=>e.login&&e.login(...t),["enter"]))},null,544),[[i["G"],e.email]]),Object(i["K"])(Object(i["g"])("input",{type:"email",placeholder:"example@example.com","onUpdate:modelValue":t[2]||(t[2]=t=>e.name=t),onKeyup:t[3]||(t[3]=Object(i["L"])((...t)=>e.login&&e.login(...t),["enter"]))},null,544),[[i["G"],e.name]])])}r("d9e2");const a="1.35.4",c={"X-Client-Info":"supabase-js/"+a},u="supabase.auth.token";function h(e){return e.replace(/\/$/,"")}const l=()=>"undefined"!==typeof window,d="1.22.20",f="http://localhost:9999",p={"X-Client-Info":"gotrue-js/"+d},v=10,m={ERROR_MESSAGE:"Request Failed",MAX_RETRIES:10,RETRY_INTERVAL:2},g="supabase.auth.token",b={name:"sb",lifetime:28800,domain:"",path:"/",sameSite:"lax"};var y=function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(t){s(t)}}function a(e){try{c(n["throw"](e))}catch(t){s(t)}}function c(e){e.done?r(e.value):i(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())}))};const _=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),w=(e,t)=>(null===e||void 0===e?void 0:e.status)?"function"!==typeof e.json?t(e):void e.json().then(r=>t({message:_(r),status:(null===e||void 0===e?void 0:e.status)||500})):t({message:m.ERROR_MESSAGE}),k=(e,t,r)=>{const n={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e||(n.headers=Object.assign({"Content-Type":"text/plain;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),n.body=JSON.stringify(r)),n};function S(e,t,r,n,i){return y(this,void 0,void 0,(function*(){return new Promise((s,o)=>{e(r,k(t,n,i)).then(e=>{if(!e.ok)throw e;return(null===n||void 0===n?void 0:n.noResolveJson)?s:e.json()}).then(e=>s(e)).catch(e=>w(e,o))})}))}function T(e,t,r){return y(this,void 0,void 0,(function*(){return S(e,"GET",t,r)}))}function O(e,t,r,n){return y(this,void 0,void 0,(function*(){return S(e,"POST",t,n,r)}))}function E(e,t,r,n){return y(this,void 0,void 0,(function*(){return S(e,"PUT",t,n,r)}))}function j(e,t,r,n){return y(this,void 0,void 0,(function*(){return S(e,"DELETE",t,n,r)}))}function x(e,t,r){const n=r||{},i=encodeURIComponent,s=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;if("function"!==typeof i)throw new TypeError("option encode is invalid");if(!s.test(e))throw new TypeError("argument name is invalid");const o=i(t);if(o&&!s.test(o))throw new TypeError("argument val is invalid");let a=e+"="+o;if(null!=n.maxAge){const e=n.maxAge-0;if(isNaN(e)||!isFinite(e))throw new TypeError("option maxAge is invalid");a+="; Max-Age="+Math.floor(e)}if(n.domain){if(!s.test(n.domain))throw new TypeError("option domain is invalid");a+="; Domain="+n.domain}if(n.path){if(!s.test(n.path))throw new TypeError("option path is invalid");a+="; Path="+n.path}if(n.expires){if("function"!==typeof n.expires.toUTCString)throw new TypeError("option expires is invalid");a+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(a+="; HttpOnly"),n.secure&&(a+="; Secure"),n.sameSite){const e="string"===typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite;switch(e){case"lax":a+="; SameSite=Lax";break;case"strict":a+="; SameSite=Strict";break;case"none":a+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return a}function P(e){if(!e||!e.headers||!e.headers.host)throw new Error('The "host" request header is not available');const t=e.headers.host.indexOf(":")>-1&&e.headers.host.split(":")[0]||e.headers.host;return!(["localhost","127.0.0.1"].indexOf(t)>-1||t.endsWith(".local"))}function R(e,t){var r,n,i;return x(e.name,e.value,{maxAge:e.maxAge,expires:new Date(Date.now()+1e3*e.maxAge),httpOnly:!0,secure:t,path:null!==(r=e.path)&&void 0!==r?r:"/",domain:null!==(n=e.domain)&&void 0!==n?n:"",sameSite:null!==(i=e.sameSite)&&void 0!==i?i:"lax"})}function C(e,t,r){const n=r.map(t=>R(t,P(e))),i=t.getHeader("Set-Cookie");return i&&(i instanceof Array?Array.prototype.push.apply(n,i):"string"===typeof i&&n.push(i)),n}function I(e,t,r){t.setHeader("Set-Cookie",C(e,t,r))}var A=function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(t){s(t)}}function a(e){try{c(n["throw"](e))}catch(t){s(t)}}function c(e){e.done?r(e.value):i(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())}))};function $(e){const t=Math.round(Date.now()/1e3);return t+e}function N(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0,r="x"==e?t:3&t|8;return r.toString(16)}))}const U=()=>"undefined"!==typeof window;function D(e,t){var r;t||(t=(null===(r=null===window||void 0===window?void 0:window.location)||void 0===r?void 0:r.href)||""),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp("[?&#]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}const L=e=>{let t;return t=e||("undefined"===typeof fetch?(...e)=>A(void 0,void 0,void 0,(function*(){return yield(yield r.e("chunk-2d0d36c0").then(r.t.bind(null,"5d61",7))).fetch(...e)})):fetch),(...e)=>t(...e)},M=(e,t,r)=>A(void 0,void 0,void 0,(function*(){U()&&(yield null===e||void 0===e?void 0:e.setItem(t,JSON.stringify(r)))})),J=(e,t)=>A(void 0,void 0,void 0,(function*(){const r=U()&&(yield null===e||void 0===e?void 0:e.getItem(t));if(!r)return null;try{return JSON.parse(r)}catch(n){return r}})),B=(e,t)=>{const r=U()&&(null===e||void 0===e?void 0:e.getItem(t));if(!r||"string"!==typeof r)return null;try{return JSON.parse(r)}catch(n){return r}},F=(e,t)=>A(void 0,void 0,void 0,(function*(){U()&&(yield null===e||void 0===e?void 0:e.removeItem(t))}));var G=function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(t){s(t)}}function a(e){try{c(n["throw"](e))}catch(t){s(t)}}function c(e){e.done?r(e.value):i(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())}))};class H{constructor({url:e="",headers:t={},cookieOptions:r,fetch:n}){this.url=e,this.headers=t,this.cookieOptions=Object.assign(Object.assign({},b),r),this.fetch=L(n)}_createRequestHeaders(e){const t=Object.assign({},this.headers);return t["Authorization"]="Bearer "+e,t}cookieName(){var e;return null!==(e=this.cookieOptions.name)&&void 0!==e?e:""}getUrlForProvider(e,t){const r=["provider="+encodeURIComponent(e)];if((null===t||void 0===t?void 0:t.redirectTo)&&r.push("redirect_to="+encodeURIComponent(t.redirectTo)),(null===t||void 0===t?void 0:t.scopes)&&r.push("scopes="+encodeURIComponent(t.scopes)),null===t||void 0===t?void 0:t.queryParams){const e=new URLSearchParams(t.queryParams);r.push(""+e)}return`${this.url}/authorize?${r.join("&")}`}signUpWithEmail(e,t,r={}){return G(this,void 0,void 0,(function*(){try{const n=Object.assign({},this.headers);let i="";r.redirectTo&&(i="?redirect_to="+encodeURIComponent(r.redirectTo));const s=yield O(this.fetch,`${this.url}/signup${i}`,{email:e,password:t,data:r.data,gotrue_meta_security:{captcha_token:r.captchaToken}},{headers:n}),o=Object.assign({},s);return o.expires_in&&(o.expires_at=$(s.expires_in)),{data:o,error:null}}catch(n){return{data:null,error:n}}}))}signInWithEmail(e,t,r={}){return G(this,void 0,void 0,(function*(){try{const n=Object.assign({},this.headers);let i="?grant_type=password";r.redirectTo&&(i+="&redirect_to="+encodeURIComponent(r.redirectTo));const s=yield O(this.fetch,`${this.url}/token${i}`,{email:e,password:t},{headers:n}),o=Object.assign({},s);return o.expires_in&&(o.expires_at=$(s.expires_in)),{data:o,error:null}}catch(n){return{data:null,error:n}}}))}signUpWithPhone(e,t,r={}){return G(this,void 0,void 0,(function*(){try{const n=Object.assign({},this.headers),i=yield O(this.fetch,this.url+"/signup",{phone:e,password:t,data:r.data,gotrue_meta_security:{captcha_token:r.captchaToken}},{headers:n}),s=Object.assign({},i);return s.expires_in&&(s.expires_at=$(i.expires_in)),{data:s,error:null}}catch(n){return{data:null,error:n}}}))}signInWithPhone(e,t){return G(this,void 0,void 0,(function*(){try{const r=Object.assign({},this.headers),n="?grant_type=password",i=yield O(this.fetch,`${this.url}/token${n}`,{phone:e,password:t},{headers:r}),s=Object.assign({},i);return s.expires_in&&(s.expires_at=$(i.expires_in)),{data:s,error:null}}catch(r){return{data:null,error:r}}}))}signInWithOpenIDConnect({id_token:e,nonce:t,client_id:r,issuer:n,provider:i}){return G(this,void 0,void 0,(function*(){try{const s=Object.assign({},this.headers),o="?grant_type=id_token",a=yield O(this.fetch,`${this.url}/token${o}`,{id_token:e,nonce:t,client_id:r,issuer:n,provider:i},{headers:s}),c=Object.assign({},a);return c.expires_in&&(c.expires_at=$(a.expires_in)),{data:c,error:null}}catch(s){return{data:null,error:s}}}))}sendMagicLinkEmail(e,t={}){var r;return G(this,void 0,void 0,(function*(){try{const n=Object.assign({},this.headers);let i="";t.redirectTo&&(i+="?redirect_to="+encodeURIComponent(t.redirectTo));const s=null===(r=t.shouldCreateUser)||void 0===r||r,o=yield O(this.fetch,`${this.url}/otp${i}`,{email:e,create_user:s,gotrue_meta_security:{captcha_token:t.captchaToken}},{headers:n});return{data:o,error:null}}catch(n){return{data:null,error:n}}}))}sendMobileOTP(e,t={}){var r;return G(this,void 0,void 0,(function*(){try{const n=null===(r=t.shouldCreateUser)||void 0===r||r,i=Object.assign({},this.headers),s=yield O(this.fetch,this.url+"/otp",{phone:e,create_user:n,gotrue_meta_security:{captcha_token:t.captchaToken}},{headers:i});return{data:s,error:null}}catch(n){return{data:null,error:n}}}))}signOut(e){return G(this,void 0,void 0,(function*(){try{return yield O(this.fetch,this.url+"/logout",{},{headers:this._createRequestHeaders(e),noResolveJson:!0}),{error:null}}catch(t){return{error:t}}}))}verifyMobileOTP(e,t,r={}){return G(this,void 0,void 0,(function*(){try{const n=Object.assign({},this.headers),i=yield O(this.fetch,this.url+"/verify",{phone:e,token:t,type:"sms",redirect_to:r.redirectTo},{headers:n}),s=Object.assign({},i);return s.expires_in&&(s.expires_at=$(i.expires_in)),{data:s,error:null}}catch(n){return{data:null,error:n}}}))}verifyOTP({email:e,phone:t,token:r,type:n="sms"},i={}){return G(this,void 0,void 0,(function*(){try{const s=Object.assign({},this.headers),o=yield O(this.fetch,this.url+"/verify",{email:e,phone:t,token:r,type:n,redirect_to:i.redirectTo},{headers:s}),a=Object.assign({},o);return a.expires_in&&(a.expires_at=$(o.expires_in)),{data:a,error:null}}catch(s){return{data:null,error:s}}}))}inviteUserByEmail(e,t={}){return G(this,void 0,void 0,(function*(){try{const r=Object.assign({},this.headers);let n="";t.redirectTo&&(n+="?redirect_to="+encodeURIComponent(t.redirectTo));const i=yield O(this.fetch,`${this.url}/invite${n}`,{email:e,data:t.data},{headers:r});return{data:i,error:null}}catch(r){return{data:null,error:r}}}))}resetPasswordForEmail(e,t={}){return G(this,void 0,void 0,(function*(){try{const r=Object.assign({},this.headers);let n="";t.redirectTo&&(n+="?redirect_to="+encodeURIComponent(t.redirectTo));const i=yield O(this.fetch,`${this.url}/recover${n}`,{email:e,gotrue_meta_security:{captcha_token:t.captchaToken}},{headers:r});return{data:i,error:null}}catch(r){return{data:null,error:r}}}))}refreshAccessToken(e){return G(this,void 0,void 0,(function*(){try{const t=yield O(this.fetch,this.url+"/token?grant_type=refresh_token",{refresh_token:e},{headers:this.headers}),r=Object.assign({},t);return r.expires_in&&(r.expires_at=$(t.expires_in)),{data:r,error:null}}catch(t){return{data:null,error:t}}}))}setAuthCookie(e,t){"POST"!==e.method&&(t.setHeader("Allow","POST"),t.status(405).end("Method Not Allowed"));const{event:r,session:n}=e.body;if(!r)throw new Error("Auth event missing!");if("SIGNED_IN"===r){if(!n)throw new Error("Auth session missing!");I(e,t,[{key:"access-token",value:n.access_token},{key:"refresh-token",value:n.refresh_token}].map(e=>{var t;return{name:`${this.cookieName()}-${e.key}`,value:e.value,domain:this.cookieOptions.domain,maxAge:null!==(t=this.cookieOptions.lifetime)&&void 0!==t?t:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}"SIGNED_OUT"===r&&I(e,t,["access-token","refresh-token"].map(e=>({name:`${this.cookieName()}-${e}`,value:"",maxAge:-1}))),t.status(200).json({})}deleteAuthCookie(e,t,{redirectTo:r="/"}){return I(e,t,["access-token","refresh-token"].map(e=>({name:`${this.cookieName()}-${e}`,value:"",maxAge:-1}))),t.redirect(307,r)}getAuthCookieString(e,t){"POST"!==e.method&&(t.setHeader("Allow","POST"),t.status(405).end("Method Not Allowed"));const{event:r,session:n}=e.body;if(!r)throw new Error("Auth event missing!");if("SIGNED_IN"===r){if(!n)throw new Error("Auth session missing!");return C(e,t,[{key:"access-token",value:n.access_token},{key:"refresh-token",value:n.refresh_token}].map(e=>{var t;return{name:`${this.cookieName()}-${e.key}`,value:e.value,domain:this.cookieOptions.domain,maxAge:null!==(t=this.cookieOptions.lifetime)&&void 0!==t?t:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}return"SIGNED_OUT"===r?C(e,t,["access-token","refresh-token"].map(e=>({name:`${this.cookieName()}-${e}`,value:"",maxAge:-1}))):t.getHeader("Set-Cookie")}generateLink(e,t,r={}){return G(this,void 0,void 0,(function*(){try{const n=yield O(this.fetch,this.url+"/admin/generate_link",{type:e,email:t,password:r.password,data:r.data,redirect_to:r.redirectTo},{headers:this.headers});return{data:n,error:null}}catch(n){return{data:null,error:n}}}))}createUser(e){return G(this,void 0,void 0,(function*(){try{const t=yield O(this.fetch,this.url+"/admin/users",e,{headers:this.headers});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}}))}listUsers(){return G(this,void 0,void 0,(function*(){try{const e=yield T(this.fetch,this.url+"/admin/users",{headers:this.headers});return{data:e.users,error:null}}catch(e){return{data:null,error:e}}}))}getUserById(e){return G(this,void 0,void 0,(function*(){try{const t=yield T(this.fetch,`${this.url}/admin/users/${e}`,{headers:this.headers});return{data:t,error:null}}catch(t){return{data:null,error:t}}}))}getUserByCookie(e,t){return G(this,void 0,void 0,(function*(){try{if(!e.cookies)throw new Error("Not able to parse cookies! When using Express make sure the cookie-parser middleware is in use!");const r=e.cookies[this.cookieName()+"-access-token"],n=e.cookies[this.cookieName()+"-refresh-token"];if(!r)throw new Error("No cookie found!");const{user:i,error:s}=yield this.getUser(r);if(s){if(!n)throw new Error("No refresh_token cookie found!");if(!t)throw new Error("You need to pass the res object to automatically refresh the session!");const{data:r,error:i}=yield this.refreshAccessToken(n);if(i)throw i;if(r)return I(e,t,[{key:"access-token",value:r.access_token},{key:"refresh-token",value:r.refresh_token}].map(e=>{var t;return{name:`${this.cookieName()}-${e.key}`,value:e.value,domain:this.cookieOptions.domain,maxAge:null!==(t=this.cookieOptions.lifetime)&&void 0!==t?t:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}})),{token:r.access_token,user:r.user,data:r.user,error:null}}return{token:r,user:i,data:i,error:null}}catch(r){return{token:null,user:null,data:null,error:r}}}))}updateUserById(e,t){return G(this,void 0,void 0,(function*(){try{const r=yield E(this.fetch,`${this.url}/admin/users/${e}`,t,{headers:this.headers});return{user:r,data:r,error:null}}catch(r){return{user:null,data:null,error:r}}}))}deleteUser(e){return G(this,void 0,void 0,(function*(){try{const t=yield j(this.fetch,`${this.url}/admin/users/${e}`,{},{headers:this.headers});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}}))}getUser(e){return G(this,void 0,void 0,(function*(){try{const t=yield T(this.fetch,this.url+"/user",{headers:this._createRequestHeaders(e)});return{user:t,data:t,error:null}}catch(t){return{user:null,data:null,error:t}}}))}updateUser(e,t){return G(this,void 0,void 0,(function*(){try{const r=yield E(this.fetch,this.url+"/user",t,{headers:this._createRequestHeaders(e)});return{user:r,data:r,error:null}}catch(r){return{user:null,data:null,error:r}}}))}}function z(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!==typeof self&&(self.globalThis=self)}}var q=function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(t){s(t)}}function a(e){try{c(n["throw"](e))}catch(t){s(t)}}function c(e){e.done?r(e.value):i(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())}))};z();const W={url:f,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:p};class K{constructor(e){this.stateChangeEmitters=new Map,this.networkRetries=0;const t=Object.assign(Object.assign({},W),e);this.currentUser=null,this.currentSession=null,this.autoRefreshToken=t.autoRefreshToken,this.persistSession=t.persistSession,this.multiTab=t.multiTab,this.localStorage=t.localStorage||globalThis.localStorage,this.api=new H({url:t.url,headers:t.headers,cookieOptions:t.cookieOptions,fetch:t.fetch}),this._recoverSession(),this._recoverAndRefresh(),this._listenForMultiTabEvents(),this._handleVisibilityChange(),t.detectSessionInUrl&&U()&&D("access_token")&&this.getSessionFromUrl({storeSession:!0}).then(({error:e})=>{if(e)throw new Error("Error getting session from URL.")})}signUp({email:e,password:t,phone:r},n={}){return q(this,void 0,void 0,(function*(){try{this._removeSession();const{data:i,error:s}=r&&t?yield this.api.signUpWithPhone(r,t,{data:n.data,captchaToken:n.captchaToken}):yield this.api.signUpWithEmail(e,t,{redirectTo:n.redirectTo,data:n.data,captchaToken:n.captchaToken});if(s)throw s;if(!i)throw"An error occurred on sign up.";let o=null,a=null;return i.access_token&&(o=i,a=o.user,this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN")),i.id&&(a=i),{user:a,session:o,error:null}}catch(i){return{user:null,session:null,error:i}}}))}signIn({email:e,phone:t,password:r,refreshToken:n,provider:i,oidc:s},o={}){return q(this,void 0,void 0,(function*(){try{if(this._removeSession(),e&&!r){const{error:t}=yield this.api.sendMagicLinkEmail(e,{redirectTo:o.redirectTo,shouldCreateUser:o.shouldCreateUser,captchaToken:o.captchaToken});return{user:null,session:null,error:t}}if(e&&r)return this._handleEmailSignIn(e,r,{redirectTo:o.redirectTo});if(t&&!r){const{error:e}=yield this.api.sendMobileOTP(t,{shouldCreateUser:o.shouldCreateUser,captchaToken:o.captchaToken});return{user:null,session:null,error:e}}if(t&&r)return this._handlePhoneSignIn(t,r);if(n){const{error:e}=yield this._callRefreshToken(n);if(e)throw e;return{user:this.currentUser,session:this.currentSession,error:null}}if(i)return this._handleProviderSignIn(i,{redirectTo:o.redirectTo,scopes:o.scopes,queryParams:o.queryParams});if(s)return this._handleOpenIDConnectSignIn(s);throw new Error("You must provide either an email, phone number, a third-party provider or OpenID Connect.")}catch(a){return{user:null,session:null,error:a}}}))}verifyOTP(e,t={}){return q(this,void 0,void 0,(function*(){try{this._removeSession();const{data:r,error:n}=yield this.api.verifyOTP(e,t);if(n)throw n;if(!r)throw"An error occurred on token verification.";let i=null,s=null;return r.access_token&&(i=r,s=i.user,this._saveSession(i),this._notifyAllSubscribers("SIGNED_IN")),r.id&&(s=r),{user:s,session:i,error:null}}catch(r){return{user:null,session:null,error:r}}}))}user(){return this.currentUser}session(){return this.currentSession}refreshSession(){var e;return q(this,void 0,void 0,(function*(){try{if(!(null===(e=this.currentSession)||void 0===e?void 0:e.access_token))throw new Error("Not logged in.");const{error:t}=yield this._callRefreshToken();if(t)throw t;return{data:this.currentSession,user:this.currentUser,error:null}}catch(t){return{data:null,user:null,error:t}}}))}update(e){var t;return q(this,void 0,void 0,(function*(){try{if(!(null===(t=this.currentSession)||void 0===t?void 0:t.access_token))throw new Error("Not logged in.");const{user:r,error:n}=yield this.api.updateUser(this.currentSession.access_token,e);if(n)throw n;if(!r)throw Error("Invalid user data.");const i=Object.assign(Object.assign({},this.currentSession),{user:r});return this._saveSession(i),this._notifyAllSubscribers("USER_UPDATED"),{data:r,user:r,error:null}}catch(r){return{data:null,user:null,error:r}}}))}setSession(e){return q(this,void 0,void 0,(function*(){try{if(!e)throw new Error("No current session.");const{data:t,error:r}=yield this.api.refreshAccessToken(e);return r?{session:null,error:r}:(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN"),{session:t,error:null})}catch(t){return{error:t,session:null}}}))}setAuth(e){return this.currentSession=Object.assign(Object.assign({},this.currentSession),{access_token:e,token_type:"bearer",user:this.user()}),this._notifyAllSubscribers("TOKEN_REFRESHED"),this.currentSession}getSessionFromUrl(e){return q(this,void 0,void 0,(function*(){try{if(!U())throw new Error("No browser detected.");const t=D("error_description");if(t)throw new Error(t);const r=D("provider_token"),n=D("access_token");if(!n)throw new Error("No access_token detected.");const i=D("expires_in");if(!i)throw new Error("No expires_in detected.");const s=D("refresh_token");if(!s)throw new Error("No refresh_token detected.");const o=D("token_type");if(!o)throw new Error("No token_type detected.");const a=Math.round(Date.now()/1e3),c=a+parseInt(i),{user:u,error:h}=yield this.api.getUser(n);if(h)throw h;const l={provider_token:r,access_token:n,expires_in:parseInt(i),expires_at:c,refresh_token:s,token_type:o,user:u};if(null===e||void 0===e?void 0:e.storeSession){this._saveSession(l);const e=D("type");this._notifyAllSubscribers("SIGNED_IN"),"recovery"===e&&this._notifyAllSubscribers("PASSWORD_RECOVERY")}return window.location.hash="",{data:l,error:null}}catch(t){return{data:null,error:t}}}))}signOut(){var e;return q(this,void 0,void 0,(function*(){const t=null===(e=this.currentSession)||void 0===e?void 0:e.access_token;if(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"),t){const{error:e}=yield this.api.signOut(t);if(e)return{error:e}}return{error:null}}))}onAuthStateChange(e){try{const t=N(),r={id:t,callback:e,unsubscribe:()=>{this.stateChangeEmitters.delete(t)}};return this.stateChangeEmitters.set(t,r),{data:r,error:null}}catch(t){return{data:null,error:t}}}_handleEmailSignIn(e,t,r={}){var n,i;return q(this,void 0,void 0,(function*(){try{const{data:s,error:o}=yield this.api.signInWithEmail(e,t,{redirectTo:r.redirectTo});return o||!s?{data:null,user:null,session:null,error:o}:(((null===(n=null===s||void 0===s?void 0:s.user)||void 0===n?void 0:n.confirmed_at)||(null===(i=null===s||void 0===s?void 0:s.user)||void 0===i?void 0:i.email_confirmed_at))&&(this._saveSession(s),this._notifyAllSubscribers("SIGNED_IN")),{data:s,user:s.user,session:s,error:null})}catch(s){return{data:null,user:null,session:null,error:s}}}))}_handlePhoneSignIn(e,t){var r;return q(this,void 0,void 0,(function*(){try{const{data:n,error:i}=yield this.api.signInWithPhone(e,t);return i||!n?{data:null,user:null,session:null,error:i}:((null===(r=null===n||void 0===n?void 0:n.user)||void 0===r?void 0:r.phone_confirmed_at)&&(this._saveSession(n),this._notifyAllSubscribers("SIGNED_IN")),{data:n,user:n.user,session:n,error:null})}catch(n){return{data:null,user:null,session:null,error:n}}}))}_handleProviderSignIn(e,t={}){const r=this.api.getUrlForProvider(e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});try{return U()&&(window.location.href=r),{provider:e,url:r,data:null,session:null,user:null,error:null}}catch(n){return r?{provider:e,url:r,data:null,session:null,user:null,error:null}:{data:null,user:null,session:null,error:n}}}_handleOpenIDConnectSignIn({id_token:e,nonce:t,client_id:r,issuer:n,provider:i}){return q(this,void 0,void 0,(function*(){if(e&&t&&(r&&n||i))try{const{data:s,error:o}=yield this.api.signInWithOpenIDConnect({id_token:e,nonce:t,client_id:r,issuer:n,provider:i});return o||!s?{user:null,session:null,error:o}:(this._saveSession(s),this._notifyAllSubscribers("SIGNED_IN"),{user:s.user,session:s,error:null})}catch(s){return{user:null,session:null,error:s}}throw new Error("You must provide a OpenID Connect provider with your id token and nonce.")}))}_recoverSession(){try{const e=B(this.localStorage,g);if(!e)return null;const{currentSession:t,expiresAt:r}=e,n=Math.round(Date.now()/1e3);r>=n+v&&(null===t||void 0===t?void 0:t.user)&&(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN"))}catch(e){console.log("error",e)}}_recoverAndRefresh(){return q(this,void 0,void 0,(function*(){try{const e=yield J(this.localStorage,g);if(!e)return null;const{currentSession:t,expiresAt:r}=e,n=Math.round(Date.now()/1e3);if(r<n+v)if(this.autoRefreshToken&&t.refresh_token){this.networkRetries++;const{error:e}=yield this._callRefreshToken(t.refresh_token);if(e){if(console.log(e.message),e.message===m.ERROR_MESSAGE&&this.networkRetries<m.MAX_RETRIES)return this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),void(this.refreshTokenTimer=setTimeout(()=>this._recoverAndRefresh(),100*Math.pow(m.RETRY_INTERVAL,this.networkRetries)));yield this._removeSession()}this.networkRetries=0}else this._removeSession();else t?(this._saveSession(t),this._notifyAllSubscribers("SIGNED_IN")):(console.log("Current session is missing data."),this._removeSession())}catch(e){return console.error(e),null}}))}_callRefreshToken(e){var t;return void 0===e&&(e=null===(t=this.currentSession)||void 0===t?void 0:t.refresh_token),q(this,void 0,void 0,(function*(){try{if(!e)throw new Error("No current session.");const{data:t,error:r}=yield this.api.refreshAccessToken(e);if(r)throw r;if(!t)throw Error("Invalid session data.");return this._saveSession(t),this._notifyAllSubscribers("TOKEN_REFRESHED"),this._notifyAllSubscribers("SIGNED_IN"),{data:t,error:null}}catch(t){return{data:null,error:t}}}))}_notifyAllSubscribers(e){this.stateChangeEmitters.forEach(t=>t.callback(e,this.currentSession))}_saveSession(e){this.currentSession=e,this.currentUser=e.user;const t=e.expires_at;if(t){const e=Math.round(Date.now()/1e3),r=t-e,n=r>v?v:.5;this._startAutoRefreshToken(1e3*(r-n))}this.persistSession&&e.expires_at&&this._persistSession(this.currentSession)}_persistSession(e){const t={currentSession:e,expiresAt:e.expires_at};M(this.localStorage,g,t)}_removeSession(){return q(this,void 0,void 0,(function*(){this.currentSession=null,this.currentUser=null,this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),F(this.localStorage,g)}))}_startAutoRefreshToken(e){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),e<=0||!this.autoRefreshToken||(this.refreshTokenTimer=setTimeout(()=>q(this,void 0,void 0,(function*(){this.networkRetries++;const{error:e}=yield this._callRefreshToken();e||(this.networkRetries=0),(null===e||void 0===e?void 0:e.message)===m.ERROR_MESSAGE&&this.networkRetries<m.MAX_RETRIES&&this._startAutoRefreshToken(100*Math.pow(m.RETRY_INTERVAL,this.networkRetries))})),e),"function"===typeof this.refreshTokenTimer.unref&&this.refreshTokenTimer.unref())}_listenForMultiTabEvents(){if(!this.multiTab||!U()||!(null===window||void 0===window?void 0:window.addEventListener))return!1;try{null===window||void 0===window||window.addEventListener("storage",e=>{var t;if(e.key===g){const r=JSON.parse(String(e.newValue));(null===(t=null===r||void 0===r?void 0:r.currentSession)||void 0===t?void 0:t.access_token)?(this._saveSession(r.currentSession),this._notifyAllSubscribers("SIGNED_IN")):(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"))}})}catch(e){console.error("_listenForMultiTabEvents",e)}}_handleVisibilityChange(){if(!this.multiTab||!U()||!(null===window||void 0===window?void 0:window.addEventListener))return!1;try{null===window||void 0===window||window.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&this._recoverAndRefresh()})}catch(e){console.error("_handleVisibilityChange",e)}}}class V extends K{constructor(e){super(e)}}var Y=function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(t){s(t)}}function a(e){try{c(n["throw"](e))}catch(t){s(t)}}function c(e){e.done?r(e.value):i(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())}))};class X{constructor(e){let t;Object.assign(this,e),t=e.fetch?e.fetch:"undefined"===typeof fetch?(...e)=>Y(this,void 0,void 0,(function*(){return yield(yield r.e("chunk-2d0d36c0").then(r.t.bind(null,"5d61",7))).fetch(...e)})):fetch,this.fetch=(...e)=>t(...e),this.shouldThrowOnError=e.shouldThrowOnError||!1,this.allowEmpty=e.allowEmpty||!1}throwOnError(e){return null!==e&&void 0!==e||(e=!0),this.shouldThrowOnError=e,this}then(e,t){"undefined"===typeof this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let r=this.fetch(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(e=>Y(this,void 0,void 0,(function*(){var t,r,n,i;let s=null,o=null,a=null,c=e.status,u=e.statusText;if(e.ok){const i=null===(t=this.headers["Prefer"])||void 0===t?void 0:t.split(",").includes("return=minimal");if("HEAD"!==this.method&&!i){const t=yield e.text();t&&(o="text/csv"===this.headers["Accept"]?t:JSON.parse(t))}const s=null===(r=this.headers["Prefer"])||void 0===r?void 0:r.match(/count=(exact|planned|estimated)/),c=null===(n=e.headers.get("content-range"))||void 0===n?void 0:n.split("/");s&&c&&c.length>1&&(a=parseInt(c[1]))}else{const t=yield e.text();try{s=JSON.parse(t)}catch(l){s={message:t}}if(s&&this.allowEmpty&&(null===(i=null===s||void 0===s?void 0:s.details)||void 0===i?void 0:i.includes("Results contain 0 rows"))&&(s=null,c=200,u="OK"),s&&this.shouldThrowOnError)throw s}const h={error:s,data:o,count:a,status:c,statusText:u,body:o};return h})));return this.shouldThrowOnError||(r=r.catch(e=>({error:{message:"FetchError: "+e.message,details:"",hint:"",code:e.code||""},data:null,body:null,count:null,status:400,statusText:"Bad Request"}))),r.then(e,t)}}class Z extends X{select(e="*"){let t=!1;const r=e.split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this}order(e,{ascending:t=!0,nullsFirst:r=!1,foreignTable:n}={}){const i="undefined"===typeof n?"order":n+".order",s=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${s?s+",":""}${e}.${t?"asc":"desc"}.${r?"nullsfirst":"nullslast"}`),this}limit(e,{foreignTable:t}={}){const r="undefined"===typeof t?"limit":t+".limit";return this.url.searchParams.set(r,""+e),this}range(e,t,{foreignTable:r}={}){const n="undefined"===typeof r?"offset":r+".offset",i="undefined"===typeof r?"limit":r+".limit";return this.url.searchParams.set(n,""+e),this.url.searchParams.set(i,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers["Accept"]="application/vnd.pgrst.object+json",this}maybeSingle(){return this.headers["Accept"]="application/vnd.pgrst.object+json",this.allowEmpty=!0,this}csv(){return this.headers["Accept"]="text/csv",this}}class Q extends Z{constructor(){super(...arguments),this.cs=this.contains,this.cd=this.containedBy,this.sl=this.rangeLt,this.sr=this.rangeGt,this.nxl=this.rangeGte,this.nxr=this.rangeLte,this.adj=this.rangeAdjacent,this.ov=this.overlaps}not(e,t,r){return this.url.searchParams.append(""+e,`not.${t}.${r}`),this}or(e,{foreignTable:t}={}){const r="undefined"===typeof t?"or":t+".or";return this.url.searchParams.append(r,`(${e})`),this}eq(e,t){return this.url.searchParams.append(""+e,"eq."+t),this}neq(e,t){return this.url.searchParams.append(""+e,"neq."+t),this}gt(e,t){return this.url.searchParams.append(""+e,"gt."+t),this}gte(e,t){return this.url.searchParams.append(""+e,"gte."+t),this}lt(e,t){return this.url.searchParams.append(""+e,"lt."+t),this}lte(e,t){return this.url.searchParams.append(""+e,"lte."+t),this}like(e,t){return this.url.searchParams.append(""+e,"like."+t),this}ilike(e,t){return this.url.searchParams.append(""+e,"ilike."+t),this}is(e,t){return this.url.searchParams.append(""+e,"is."+t),this}in(e,t){const r=t.map(e=>"string"===typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:""+e).join(",");return this.url.searchParams.append(""+e,`in.(${r})`),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(""+e,"cs."+t):Array.isArray(t)?this.url.searchParams.append(""+e,`cs.{${t.join(",")}}`):this.url.searchParams.append(""+e,"cs."+JSON.stringify(t)),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(""+e,"cd."+t):Array.isArray(t)?this.url.searchParams.append(""+e,`cd.{${t.join(",")}}`):this.url.searchParams.append(""+e,"cd."+JSON.stringify(t)),this}rangeLt(e,t){return this.url.searchParams.append(""+e,"sl."+t),this}rangeGt(e,t){return this.url.searchParams.append(""+e,"sr."+t),this}rangeGte(e,t){return this.url.searchParams.append(""+e,"nxl."+t),this}rangeLte(e,t){return this.url.searchParams.append(""+e,"nxr."+t),this}rangeAdjacent(e,t){return this.url.searchParams.append(""+e,"adj."+t),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(""+e,"ov."+t):this.url.searchParams.append(""+e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n=null}={}){let i="";"plain"===n?i="pl":"phrase"===n?i="ph":"websearch"===n&&(i="w");const s=void 0===r?"":`(${r})`;return this.url.searchParams.append(""+e,`${i}fts${s}.${t}`),this}fts(e,t,{config:r}={}){const n="undefined"===typeof r?"":`(${r})`;return this.url.searchParams.append(""+e,`fts${n}.${t}`),this}plfts(e,t,{config:r}={}){const n="undefined"===typeof r?"":`(${r})`;return this.url.searchParams.append(""+e,`plfts${n}.${t}`),this}phfts(e,t,{config:r}={}){const n="undefined"===typeof r?"":`(${r})`;return this.url.searchParams.append(""+e,`phfts${n}.${t}`),this}wfts(e,t,{config:r}={}){const n="undefined"===typeof r?"":`(${r})`;return this.url.searchParams.append(""+e,`wfts${n}.${t}`),this}filter(e,t,r){return this.url.searchParams.append(""+e,`${t}.${r}`),this}match(e){return Object.keys(e).forEach(t=>{this.url.searchParams.append(""+t,"eq."+e[t])}),this}}class ee extends X{constructor(e,{headers:t={},schema:r,fetch:n,shouldThrowOnError:i}={}){super({fetch:n,shouldThrowOnError:i}),this.url=new URL(e),this.headers=Object.assign({},t),this.schema=r}select(e="*",{head:t=!1,count:r=null}={}){this.method="GET";let n=!1;const i=e.split("").map(e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e)).join("");return this.url.searchParams.set("select",i),r&&(this.headers["Prefer"]="count="+r),t&&(this.method="HEAD"),new Q(this)}insert(e,{upsert:t=!1,onConflict:r,returning:n="representation",count:i=null}={}){this.method="POST";const s=["return="+n];if(t&&s.push("resolution=merge-duplicates"),t&&void 0!==r&&this.url.searchParams.set("on_conflict",r),this.body=e,i&&s.push("count="+i),this.headers["Prefer"]&&s.unshift(this.headers["Prefer"]),this.headers["Prefer"]=s.join(","),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new Q(this)}upsert(e,{onConflict:t,returning:r="representation",count:n=null,ignoreDuplicates:i=!1}={}){this.method="POST";const s=[`resolution=${i?"ignore":"merge"}-duplicates`,"return="+r];return void 0!==t&&this.url.searchParams.set("on_conflict",t),this.body=e,n&&s.push("count="+n),this.headers["Prefer"]&&s.unshift(this.headers["Prefer"]),this.headers["Prefer"]=s.join(","),new Q(this)}update(e,{returning:t="representation",count:r=null}={}){this.method="PATCH";const n=["return="+t];return this.body=e,r&&n.push("count="+r),this.headers["Prefer"]&&n.unshift(this.headers["Prefer"]),this.headers["Prefer"]=n.join(","),new Q(this)}delete({returning:e="representation",count:t=null}={}){this.method="DELETE";const r=["return="+e];return t&&r.push("count="+t),this.headers["Prefer"]&&r.unshift(this.headers["Prefer"]),this.headers["Prefer"]=r.join(","),new Q(this)}}class te extends X{constructor(e,{headers:t={},schema:r,fetch:n,shouldThrowOnError:i}={}){super({fetch:n,shouldThrowOnError:i}),this.url=new URL(e),this.headers=Object.assign({},t),this.schema=r}rpc(e,{head:t=!1,count:r=null}={}){return t?(this.method="HEAD",e&&Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,t)})):(this.method="POST",this.body=e),r&&(void 0!==this.headers["Prefer"]?this.headers["Prefer"]+=",count="+r:this.headers["Prefer"]="count="+r),new Q(this)}}const re="0.37.4",ne={"X-Client-Info":"postgrest-js/"+re};class ie{constructor(e,{headers:t={},schema:r,fetch:n,throwOnError:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},ne),t),this.schema=r,this.fetch=n,this.shouldThrowOnError=i}auth(e){return this.headers["Authorization"]="Bearer "+e,this}from(e){const t=`${this.url}/${e}`;return new ee(t,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(e,t,{head:r=!1,count:n=null}={}){const i=`${this.url}/rpc/${e}`;return new te(i,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError}).rpc(t,{head:r,count:n})}}var se;(function(e){e["abstime"]="abstime",e["bool"]="bool",e["date"]="date",e["daterange"]="daterange",e["float4"]="float4",e["float8"]="float8",e["int2"]="int2",e["int4"]="int4",e["int4range"]="int4range",e["int8"]="int8",e["int8range"]="int8range",e["json"]="json",e["jsonb"]="jsonb",e["money"]="money",e["numeric"]="numeric",e["oid"]="oid",e["reltime"]="reltime",e["text"]="text",e["time"]="time",e["timestamp"]="timestamp",e["timestamptz"]="timestamptz",e["timetz"]="timetz",e["tsrange"]="tsrange",e["tstzrange"]="tstzrange"})(se||(se={}));const oe=(e,t,r={})=>{var n;const i=null!==(n=r.skipTypes)&&void 0!==n?n:[];return Object.keys(t).reduce((r,n)=>(r[n]=ae(n,e,t,i),r),{})},ae=(e,t,r,n)=>{const i=t.find(t=>t.name===e),s=null===i||void 0===i?void 0:i.type,o=r[e];return s&&!n.includes(s)?ce(s,o):ue(o)},ce=(e,t)=>{if("_"===e.charAt(0)){const r=e.slice(1,e.length);return fe(t,r)}switch(e){case se.bool:return he(t);case se.float4:case se.float8:case se.int2:case se.int4:case se.int8:case se.numeric:case se.oid:return le(t);case se.json:case se.jsonb:return de(t);case se.timestamp:return pe(t);case se.abstime:case se.date:case se.daterange:case se.int4range:case se.int8range:case se.money:case se.reltime:case se.text:case se.time:case se.timestamptz:case se.timetz:case se.tsrange:case se.tstzrange:return ue(t);default:return ue(t)}},ue=e=>e,he=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},le=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},de=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return console.log("JSON parse error: "+t),e}return e},fe=(e,t)=>{if("string"!==typeof e)return e;const r=e.length-1,n=e[r],i=e[0];if("{"===i&&"}"===n){let n;const i=e.slice(1,r);try{n=JSON.parse("["+i+"]")}catch(s){n=i?i.split(","):[]}return n.map(e=>ce(t,e))}return e},pe=e=>"string"===typeof e?e.replace(" ","T"):e;var ve=r("7e3c");const me="1.7.3",ge={"X-Client-Info":"realtime-js/"+me},be="1.0.0",ye=1e4,_e=1e3;var we,ke,Se,Te,Oe;(function(e){e[e["connecting"]=0]="connecting",e[e["open"]=1]="open",e[e["closing"]=2]="closing",e[e["closed"]=3]="closed"})(we||(we={})),function(e){e["closed"]="closed",e["errored"]="errored",e["joined"]="joined",e["joining"]="joining",e["leaving"]="leaving"}(ke||(ke={})),function(e){e["close"]="phx_close",e["error"]="phx_error",e["join"]="phx_join",e["reply"]="phx_reply",e["leave"]="phx_leave",e["access_token"]="access_token"}(Se||(Se={})),function(e){e["websocket"]="websocket"}(Te||(Te={})),function(e){e["Connecting"]="connecting",e["Open"]="open",e["Closing"]="closing",e["Closed"]="closed"}(Oe||(Oe={}));class Ee{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class je{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"===typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const n=t.getUint8(1),i=t.getUint8(2);let s=this.HEADER_LENGTH+2;const o=r.decode(e.slice(s,s+n));s+=n;const a=r.decode(e.slice(s,s+i));s+=i;const c=JSON.parse(r.decode(e.slice(s,e.byteLength)));return{ref:null,topic:o,event:a,payload:c}}}class xe{constructor(e,t,r={},n=ye){this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref);const e=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel instanceof Pe?this.channel.on(this.refEvent,e):this.channel.on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel.trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&(this.channel instanceof Pe?this.channel.off(this.refEvent):this.channel.off(this.refEvent,{}))}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}class Pe{constructor(e,t={},r){this.topic=e,this.params=t,this.socket=r,this.bindings=[],this.state=ke.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new xe(this,Se.join,this.params,this.timeout),this.rejoinTimer=new Ee(()=>this.rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ke.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=ke.closed,this.socket.remove(this)}),this.onError(e=>{this.isLeaving()||this.isClosed()||(this.socket.log("channel","error "+this.topic,e),this.state=ke.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this.isJoining()&&(this.socket.log("channel","timeout "+this.topic,this.joinPush.timeout),this.state=ke.errored,this.rejoinTimer.scheduleTimeout())}),this.on(Se.reply,(e,t)=>{this.trigger(this.replyEventName(t),e)})}rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}subscribe(e=this.timeout){if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";return this.joinedOnce=!0,this.rejoin(e),this.joinPush}onClose(e){this.on(Se.close,e)}onError(e){this.on(Se.error,t=>e(t))}on(e,t){this.bindings.push({event:e,callback:t})}off(e){this.bindings=this.bindings.filter(t=>t.event!==e)}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new xe(this,e,t,r);return this.canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ke.leaving;let t=()=>{this.socket.log("channel","leave "+this.topic),this.trigger(Se.close,"leave",this.joinRef())};this.joinPush.destroy();let r=new xe(this,Se.leave,{},e);return r.receive("ok",()=>t()).receive("timeout",()=>t()),r.send(),this.canPush()||r.trigger("ok",{}),r}onMessage(e,t,r){return t}isMember(e){return this.topic===e}joinRef(){return this.joinPush.ref}rejoin(e=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=ke.joining,this.joinPush.resend(e))}trigger(e,t,r){let{close:n,error:i,leave:s,join:o}=Se,a=[n,i,s,o];if(r&&a.indexOf(e)>=0&&r!==this.joinRef())return;let c=this.onMessage(e,t,r);if(t&&!c)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(r=>"*"===r.event?e===(null===t||void 0===t?void 0:t.type):r.event===e).map(e=>e.callback(c,r))}replyEventName(e){return"chan_reply_"+e}isClosed(){return this.state===ke.closed}isErrored(){return this.state===ke.errored}isJoined(){return this.state===ke.joined}isJoining(){return this.state===ke.joining}isLeaving(){return this.state===ke.leaving}}class Re{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel.on(r.state,{},e=>{const{onJoin:t,onLeave:r,onSync:n}=this.caller;this.joinRef=this.channel.joinRef(),this.state=Re.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=Re.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],n()}),this.channel.on(r.diff,{},e=>{const{onJoin:t,onLeave:r,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=Re.syncDiff(this.state,e,t,r),n())})}static syncState(e,t,r,n){const i=this.cloneDeep(e),s=this.transformState(t),o={},a={};return this.map(i,(e,t)=>{s[e]||(a[e]=t)}),this.map(s,(e,t)=>{const r=i[e];if(r){const n=t.map(e=>e.presence_id),i=r.map(e=>e.presence_id),s=t.filter(e=>i.indexOf(e.presence_id)<0),c=r.filter(e=>n.indexOf(e.presence_id)<0);s.length>0&&(o[e]=s),c.length>0&&(a[e]=c)}else o[e]=t}),this.syncDiff(i,{joins:o,leaves:a},r,n)}static syncDiff(e,t,r,n){const{joins:i,leaves:s}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(i,(t,n)=>{const i=e[t];if(e[t]=this.cloneDeep(n),i){const r=e[t].map(e=>e.presence_id),n=i.filter(e=>r.indexOf(e.presence_id)<0);e[t].unshift(...n)}r(t,i,n)}),this.map(s,(t,r)=>{let i=e[t];if(!i)return;const s=r.map(e=>e.presence_id);i=i.filter(e=>s.indexOf(e.presence_id)<0),e[t]=i,n(t,i,r),0===i.length&&delete e[t]}),e}static list(e,t){return t||(t=(e,t)=>t),this.map(e,(e,r)=>t(e,r))}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const n=e[r];return t[r]="metas"in n?n.metas.map(e=>(e["presence_id"]=e["phx_ref"],delete e["phx_ref"],delete e["phx_ref_prev"],e)):n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}list(e){return Re.list(this.state,e)}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel.joinRef()}}class Ce{constructor(e,t={},r){this.topic=e,this.params=t,this.socket=r,this.bindings=[],this.state=ke.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new xe(this,Se.join,this.params,this.timeout),this.rejoinTimer=new Ee(()=>this.rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ke.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=ke.closed,this.socket.remove(this)}),this.onError(e=>{this.isLeaving()||this.isClosed()||(this.socket.log("channel","error "+this.topic,e),this.state=ke.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this.isJoining()&&(this.socket.log("channel","timeout "+this.topic,this.joinPush.timeout),this.state=ke.errored,this.rejoinTimer.scheduleTimeout())}),this.on(Se.reply,{},(e,t)=>{this.trigger(this.replyEventName(t),e)}),this.presence=new Re(this)}list(){return this.presence.list()}rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}subscribe(e=this.timeout){if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const t=this.bindings.reduce((e,t)=>{const{type:r}=t;return["phx_close","phx_error","phx_reply","presence_diff","presence_state"].includes(r)||(e[r]=t),e},{});return Object.keys(t).length&&this.updateJoinPayload({configs:t}),this.joinedOnce=!0,this.rejoin(e),this.joinPush}}onClose(e){this.on(Se.close,{},e)}onError(e){this.on(Se.error,{},t=>e(t))}on(e,t,r){this.bindings.push({type:e,filter:null!==t&&void 0!==t?t:{},callback:null!==r&&void 0!==r?r:()=>{}})}off(e,t){this.bindings=this.bindings.filter(r=>!(r.type===e&&Ce.isEqual(r.filter,t)))}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new xe(this,e,t,r);return this.canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ke.leaving;const t=()=>{this.socket.log("channel","leave "+this.topic),this.trigger(Se.close,"leave",this.joinRef())};this.joinPush.destroy();const r=new xe(this,Se.leave,{},e);return r.receive("ok",()=>t()).receive("timeout",()=>t()),r.send(),this.canPush()||r.trigger("ok",{}),r}onMessage(e,t,r){return t}isMember(e){return this.topic===e}joinRef(){return this.joinPush.ref}rejoin(e=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=ke.joining,this.joinPush.resend(e))}trigger(e,t,r){const{close:n,error:i,leave:s,join:o}=Se,a=[n,i,s,o];if(r&&a.indexOf(e)>=0&&r!==this.joinRef())return;const c=this.onMessage(e,t,r);if(t&&!c)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(r=>{var n,i;return(null===r||void 0===r?void 0:r.type)===e&&("*"===(null===(n=null===r||void 0===r?void 0:r.filter)||void 0===n?void 0:n.event)||(null===(i=null===r||void 0===r?void 0:r.filter)||void 0===i?void 0:i.event)===(null===t||void 0===t?void 0:t.event))}).map(e=>e.callback(c,r))}send(e){const t=this.push(e.type,e);return new Promise(e=>{t.receive("ok",()=>e("ok")),t.receive("timeout",()=>e("timeout"))})}replyEventName(e){return"chan_reply_"+e}isClosed(){return this.state===ke.closed}isErrored(){return this.state===ke.errored}isJoined(){return this.state===ke.joined}isJoining(){return this.state===ke.joining}isLeaving(){return this.state===ke.leaving}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}}var Ie=function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(t){s(t)}}function a(e){try{c(n["throw"](e))}catch(t){s(t)}}function c(e){e.done?r(e.value):i(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())}))},Ae=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};const $e=()=>{};class Ne{constructor(e,t){this.accessToken=null,this.channels=[],this.endPoint="",this.headers=ge,this.params={},this.timeout=ye,this.transport=ve["w3cwebsocket"],this.heartbeatIntervalMs=3e4,this.longpollerTimeout=2e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=$e,this.conn=null,this.sendBuffer=[],this.serializer=new je,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.endPoint=`${e}/${Te.websocket}`,(null===t||void 0===t?void 0:t.params)&&(this.params=t.params),(null===t||void 0===t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null===t||void 0===t?void 0:t.timeout)&&(this.timeout=t.timeout),(null===t||void 0===t?void 0:t.logger)&&(this.logger=t.logger),(null===t||void 0===t?void 0:t.transport)&&(this.transport=t.transport),(null===t||void 0===t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs),(null===t||void 0===t?void 0:t.longpollerTimeout)&&(this.longpollerTimeout=t.longpollerTimeout),this.reconnectAfterMs=(null===t||void 0===t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null===t||void 0===t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null===t||void 0===t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Ee(()=>Ie(this,void 0,void 0,(function*(){yield this.disconnect(),this.connect()})),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this.endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this.onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e)))}disconnect(e,t){return new Promise((r,n)=>{try{this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t||""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset()),r({error:null,data:!0})}catch(i){r({error:i,data:!1})}})}log(e,t,r){this.logger(e,t,r)}onOpen(e){this.stateChangeCallbacks.open.push(e)}onClose(e){this.stateChangeCallbacks.close.push(e)}onError(e){this.stateChangeCallbacks.error.push(e)}onMessage(e){this.stateChangeCallbacks.message.push(e)}connectionState(){switch(this.conn&&this.conn.readyState){case we.connecting:return Oe.Connecting;case we.open:return Oe.Open;case we.closing:return Oe.Closing;default:return Oe.Closed}}isConnected(){return this.connectionState()===Oe.Open}remove(e){this.channels=this.channels.filter(t=>t.joinRef()!==e.joinRef())}channel(e,t={}){var r;const{selfBroadcast:n}=t,i=Ae(t,["selfBroadcast"]);n&&(i.self_broadcast=n);const s=(null===(r=this.params)||void 0===r?void 0:r.vsndate)?new Ce(e,i,this):new Pe(e,i,this);return s instanceof Ce&&(s.presence.onJoin((e,t,r)=>{s.trigger("presence",{event:"JOIN",key:e,currentPresences:t,newPresences:r})}),s.presence.onLeave((e,t,r)=>{s.trigger("presence",{event:"LEAVE",key:e,currentPresences:t,leftPresences:r})}),s.presence.onSync(()=>{s.trigger("presence",{event:"SYNC"})})),this.channels.push(s),s}push(e){const{topic:t,event:r,payload:n,ref:i}=e;let s=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${r} (${i})`,n),this.isConnected()?s():this.sendBuffer.push(s)}onConnMessage(e){this.decode(e.data,e=>{let{topic:t,event:r,payload:n,ref:i}=e;(i&&i===this.pendingHeartbeatRef||r===(null===n||void 0===n?void 0:n.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${n.status||""} ${t} ${r} ${i&&"("+i+")"||""}`,n),this.channels.filter(e=>e.isMember(t)).forEach(e=>e.trigger(r,n,i)),this.stateChangeCallbacks.message.forEach(t=>t(e))})}endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:be}))}makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({user_token:e}),t.joinedOnce&&t.isJoined()&&t.push(Se.access_token,{access_token:e})})}leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t.isJoined()||t.isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_onConnOpen(){this.log("transport","connected to "+this.endPointURL()),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e.trigger(Se.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const r=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${r}${n}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(_e,"hearbeat timeout"));this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class Ue{constructor(e,t,r,n){const i={},s="*"===n?"realtime:"+r:`realtime:${r}:${n}`,o=t["Authorization"].split(" ")[1];o&&(i["user_token"]=o),this.subscription=e.channel(s,i)}getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=n.convertChangeData(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=n.convertChangeData(e.columns,e.old_record)),t}on(e,t){return this.subscription.on(e,e=>{let r={schema:e.schema,table:e.table,commit_timestamp:e.commit_timestamp,eventType:e.type,new:{},old:{},errors:e.errors};r=Object.assign(Object.assign({},r),this.getPayloadRecords(e)),t(r)}),this}subscribe(e=(()=>{})){return this.subscription.onError(t=>e("SUBSCRIPTION_ERROR",t)),this.subscription.onClose(()=>e("CLOSED")),this.subscription.subscribe().receive("ok",()=>e("SUBSCRIBED")).receive("error",t=>e("SUBSCRIPTION_ERROR",t)).receive("timeout",()=>e("RETRYING_AFTER_TIMEOUT")),this.subscription}}class De extends ee{constructor(e,{headers:t={},schema:r,realtime:n,table:i,fetch:s,shouldThrowOnError:o}){super(e,{headers:t,schema:r,fetch:s,shouldThrowOnError:o}),this._subscription=null,this._realtime=n,this._headers=t,this._schema=r,this._table=i}on(e,t){return this._realtime.isConnected()||this._realtime.connect(),this._subscription||(this._subscription=new Ue(this._realtime,this._headers,this._schema,this._table)),this._subscription.on(e,t)}}const Le="0.0.0",Me={"X-Client-Info":"storage-js/"+Le};var Je=function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(t){s(t)}}function a(e){try{c(n["throw"](e))}catch(t){s(t)}}function c(e){e.done?r(e.value):i(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())}))};const Be=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Fe=(e,t)=>{if("function"!==typeof e.json)return t(e);e.json().then(r=>t({message:Be(r),status:(null===e||void 0===e?void 0:e.status)||500}))},Ge=(e,t,r,n)=>{const i={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?i:(i.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};function He(e,t,r,n,i,s){return Je(this,void 0,void 0,(function*(){return new Promise((o,a)=>{e(r,Ge(t,n,i,s)).then(e=>{if(!e.ok)throw e;return(null===n||void 0===n?void 0:n.noResolveJson)?o(e):e.json()}).then(e=>o(e)).catch(e=>Fe(e,a))})}))}function ze(e,t,r,n){return Je(this,void 0,void 0,(function*(){return He(e,"GET",t,r,n)}))}function qe(e,t,r,n,i){return Je(this,void 0,void 0,(function*(){return He(e,"POST",t,n,i,r)}))}function We(e,t,r,n,i){return Je(this,void 0,void 0,(function*(){return He(e,"PUT",t,n,i,r)}))}function Ke(e,t,r,n,i){return Je(this,void 0,void 0,(function*(){return He(e,"DELETE",t,n,i,r)}))}var Ve=function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(t){s(t)}}function a(e){try{c(n["throw"](e))}catch(t){s(t)}}function c(e){e.done?r(e.value):i(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())}))};const Ye=e=>{let t;return t=e||("undefined"===typeof fetch?(...e)=>Ve(void 0,void 0,void 0,(function*(){return yield(yield r.e("chunk-2d0d36c0").then(r.t.bind(null,"5d61",7))).fetch(...e)})):fetch),(...e)=>t(...e)};var Xe=function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(t){s(t)}}function a(e){try{c(n["throw"](e))}catch(t){s(t)}}function c(e){e.done?r(e.value):i(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())}))};class Ze{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},Me),t),this.fetch=Ye(r)}listBuckets(){return Xe(this,void 0,void 0,(function*(){try{const e=yield ze(this.fetch,this.url+"/bucket",{headers:this.headers});return{data:e,error:null}}catch(e){return{data:null,error:e}}}))}getBucket(e){return Xe(this,void 0,void 0,(function*(){try{const t=yield ze(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers});return{data:t,error:null}}catch(t){return{data:null,error:t}}}))}createBucket(e,t={public:!1}){return Xe(this,void 0,void 0,(function*(){try{const r=yield qe(this.fetch,this.url+"/bucket",{id:e,name:e,public:t.public},{headers:this.headers});return{data:r.name,error:null}}catch(r){return{data:null,error:r}}}))}updateBucket(e,t){return Xe(this,void 0,void 0,(function*(){try{const r=yield We(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public},{headers:this.headers});return{data:r,error:null}}catch(r){return{data:null,error:r}}}))}emptyBucket(e){return Xe(this,void 0,void 0,(function*(){try{const t=yield qe(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers});return{data:t,error:null}}catch(t){return{data:null,error:t}}}))}deleteBucket(e){return Xe(this,void 0,void 0,(function*(){try{const t=yield Ke(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers});return{data:t,error:null}}catch(t){return{data:null,error:t}}}))}}var Qe=function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(t){s(t)}}function a(e){try{c(n["throw"](e))}catch(t){s(t)}}function c(e){e.done?r(e.value):i(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())}))};const et={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},tt={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class rt{constructor(e,t={},r,n){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Ye(n)}uploadOrUpdate(e,t,r,n){return Qe(this,void 0,void 0,(function*(){try{let i;const s=Object.assign(Object.assign({},tt),n),o=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(s.upsert)});"undefined"!==typeof Blob&&r instanceof Blob?(i=new FormData,i.append("cacheControl",s.cacheControl),i.append("",r)):"undefined"!==typeof FormData&&r instanceof FormData?(i=r,i.append("cacheControl",s.cacheControl)):(i=r,o["cache-control"]="max-age="+s.cacheControl,o["content-type"]=s.contentType);const a=this._removeEmptyFolders(t),c=this._getFinalPath(a),u=yield this.fetch(`${this.url}/object/${c}`,{method:e,body:i,headers:o});if(u.ok)return{data:{Key:c},error:null};{const e=yield u.json();return{data:null,error:e}}}catch(i){return{data:null,error:i}}}))}upload(e,t,r){return Qe(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,r)}))}update(e,t,r){return Qe(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,r)}))}move(e,t){return Qe(this,void 0,void 0,(function*(){try{const r=yield qe(this.fetch,this.url+"/object/move",{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers});return{data:r,error:null}}catch(r){return{data:null,error:r}}}))}copy(e,t){return Qe(this,void 0,void 0,(function*(){try{const r=yield qe(this.fetch,this.url+"/object/copy",{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers});return{data:r,error:null}}catch(r){return{data:null,error:r}}}))}createSignedUrl(e,t){return Qe(this,void 0,void 0,(function*(){try{const r=this._getFinalPath(e);let n=yield qe(this.fetch,`${this.url}/object/sign/${r}`,{expiresIn:t},{headers:this.headers});const i=`${this.url}${n.signedURL}`;return n={signedURL:i},{data:n,error:null,signedURL:i}}catch(r){return{data:null,error:r,signedURL:null}}}))}createSignedUrls(e,t){return Qe(this,void 0,void 0,(function*(){try{const r=yield qe(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers});return{data:r.map(e=>Object.assign(Object.assign({},e),{signedURL:e.signedURL?`${this.url}${e.signedURL}`:null})),error:null}}catch(r){return{data:null,error:r}}}))}download(e){return Qe(this,void 0,void 0,(function*(){try{const t=this._getFinalPath(e),r=yield ze(this.fetch,`${this.url}/object/${t}`,{headers:this.headers,noResolveJson:!0}),n=yield r.blob();return{data:n,error:null}}catch(t){return{data:null,error:t}}}))}getPublicUrl(e){try{const t=this._getFinalPath(e),r=`${this.url}/object/public/${t}`,n={publicURL:r};return{data:n,error:null,publicURL:r}}catch(t){return{data:null,error:t,publicURL:null}}}remove(e){return Qe(this,void 0,void 0,(function*(){try{const t=yield Ke(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers});return{data:t,error:null}}catch(t){return{data:null,error:t}}}))}list(e,t,r){return Qe(this,void 0,void 0,(function*(){try{const n=Object.assign(Object.assign(Object.assign({},et),t),{prefix:e||""}),i=yield qe(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r);return{data:i,error:null}}catch(n){return{data:null,error:n}}}))}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}}class nt extends Ze{constructor(e,t={},r){super(e,t,r)}from(e){return new rt(this.url,this.headers,e,this.fetch)}}var it=function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(t){s(t)}}function a(e){try{c(n["throw"](e))}catch(t){s(t)}}function c(e){e.done?r(e.value):i(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())}))};const st=e=>{let t;return t=e||("undefined"===typeof fetch?(...e)=>it(void 0,void 0,void 0,(function*(){return yield(yield r.e("chunk-2d0d36c0").then(r.t.bind(null,"5d61",7))).fetch(...e)})):fetch),(...e)=>t(...e)};var ot=function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(t){s(t)}}function a(e){try{c(n["throw"](e))}catch(t){s(t)}}function c(e){e.done?r(e.value):i(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())}))};class at{constructor(e,{headers:t={},customFetch:r}={}){this.url=e,this.headers=t,this.fetch=st(r)}setAuth(e){this.headers.Authorization="Bearer "+e}invoke(e,t){return ot(this,void 0,void 0,(function*(){try{const{headers:r,body:n}=null!==t&&void 0!==t?t:{},i=yield this.fetch(`${this.url}/${e}`,{method:"POST",headers:Object.assign({},this.headers,r),body:n}),s=i.headers.get("x-relay-error");if(s&&"true"===s)return{data:null,error:new Error(yield i.text())};let o;const{responseType:a}=null!==t&&void 0!==t?t:{};return o=a&&"json"!==a?"arrayBuffer"===a?yield i.arrayBuffer():"blob"===a?yield i.blob():yield i.text():yield i.json(),{data:o,error:null}}catch(r){return{data:null,error:r}}}))}}var ct=function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(t){s(t)}}function a(e){try{c(n["throw"](e))}catch(t){s(t)}}function c(e){e.done?r(e.value):i(e.value).then(o,a)}c((n=n.apply(e,t||[])).next())}))};const ut={schema:"public",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:c};class ht{constructor(e,t,r){if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const n=h(e),i=Object.assign(Object.assign({},ut),r);this.restUrl=n+"/rest/v1",this.realtimeUrl=(n+"/realtime/v1").replace("http","ws"),this.authUrl=n+"/auth/v1",this.storageUrl=n+"/storage/v1";const s=n.match(/(supabase\.co)|(supabase\.in)/);if(s){const e=n.split(".");this.functionsUrl=`${e[0]}.functions.${e[1]}.${e[2]}`}else this.functionsUrl=n+"/functions/v1";this.schema=i.schema,this.multiTab=i.multiTab,this.fetch=i.fetch,this.headers=Object.assign(Object.assign({},c),null===r||void 0===r?void 0:r.headers),this.shouldThrowOnError=i.shouldThrowOnError||!1,this.auth=this._initSupabaseAuthClient(i),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},i.realtime)),this._listenForAuthEvents(),this._listenForMultiTabEvents()}get functions(){return new at(this.functionsUrl,{headers:this._getAuthHeaders(),customFetch:this.fetch})}get storage(){return new nt(this.storageUrl,this._getAuthHeaders(),this.fetch)}from(e){const t=`${this.restUrl}/${e}`;return new De(t,{headers:this._getAuthHeaders(),schema:this.schema,realtime:this.realtime,table:e,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(e,t,{head:r=!1,count:n=null}={}){const i=this._initPostgRESTClient();return i.rpc(e,t,{head:r,count:n})}channel(e,t){var r,n;const i=null!==(n=null===(r=this.auth.session())||void 0===r?void 0:r.access_token)&&void 0!==n?n:this.supabaseKey;return this.realtime.isConnected()||this.realtime.connect(),this.realtime.channel(e,Object.assign(Object.assign({},t),{user_token:i}))}removeAllSubscriptions(){return ct(this,void 0,void 0,(function*(){const e=this.getSubscriptions().slice(),t=e.map(e=>this.removeSubscription(e)),r=yield Promise.all(t);return r.map(({error:t},r)=>({data:{subscription:e[r]},error:t}))}))}removeChannel(e){return ct(this,void 0,void 0,(function*(){const{error:t}=yield this._closeSubscription(e),r=this.getSubscriptions(),n=r.filter(e=>e.isJoined()).length;return 0===r.length&&(yield this.realtime.disconnect()),{data:{openChannels:n},error:t}}))}removeSubscription(e){return ct(this,void 0,void 0,(function*(){const{error:t}=yield this._closeSubscription(e),r=this.getSubscriptions(),n=r.filter(e=>e.isJoined()).length;return 0===r.length&&(yield this.realtime.disconnect()),{data:{openSubscriptions:n},error:t}}))}_closeSubscription(e){return ct(this,void 0,void 0,(function*(){let t=null;if(!e.isClosed()){const{error:r}=yield this._unsubscribeSubscription(e);t=r}return this.realtime.remove(e),{error:t}}))}_unsubscribeSubscription(e){return new Promise(t=>{e.unsubscribe().receive("ok",()=>t({error:null})).receive("error",e=>t({error:e})).receive("timeout",()=>t({error:new Error("timed out")}))})}getSubscriptions(){return this.realtime.channels}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,localStorage:n,headers:i,fetch:s,cookieOptions:o,multiTab:a}){const c={Authorization:"Bearer "+this.supabaseKey,apikey:""+this.supabaseKey};return new V({url:this.authUrl,headers:Object.assign(Object.assign({},i),c),autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,localStorage:n,fetch:s,cookieOptions:o,multiTab:a})}_initRealtimeClient(e){return new Ne(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign(Object.assign({},null===e||void 0===e?void 0:e.params),{apikey:this.supabaseKey})}))}_initPostgRESTClient(){return new ie(this.restUrl,{headers:this._getAuthHeaders(),schema:this.schema,fetch:this.fetch,throwOnError:this.shouldThrowOnError})}_getAuthHeaders(){var e,t;const r=Object.assign({},this.headers),n=null!==(t=null===(e=this.auth.session())||void 0===e?void 0:e.access_token)&&void 0!==t?t:this.supabaseKey;return r["apikey"]=this.supabaseKey,r["Authorization"]=r["Authorization"]||"Bearer "+n,r}_listenForMultiTabEvents(){if(!this.multiTab||!l()||!(null===window||void 0===window?void 0:window.addEventListener))return null;try{return null===window||void 0===window?void 0:window.addEventListener("storage",e=>{var t,r,n;if(e.key===u){const i=JSON.parse(String(e.newValue)),s=null!==(r=null===(t=null===i||void 0===i?void 0:i.currentSession)||void 0===t?void 0:t.access_token)&&void 0!==r?r:void 0,o=null===(n=this.auth.session())||void 0===n?void 0:n.access_token;s?!o&&s?this._handleTokenChanged("SIGNED_IN",s,"STORAGE"):o!==s&&this._handleTokenChanged("TOKEN_REFRESHED",s,"STORAGE"):this._handleTokenChanged("SIGNED_OUT",s,"STORAGE")}})}catch(e){return console.error("_listenForMultiTabEvents",e),null}}_listenForAuthEvents(){let{data:e}=this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,null===t||void 0===t?void 0:t.access_token,"CLIENT")});return e}_handleTokenChanged(e,t,r){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===t?"SIGNED_OUT"!==e&&"USER_DELETED"!==e||(this.realtime.setAuth(this.supabaseKey),"STORAGE"==r&&this.auth.signOut()):(this.realtime.setAuth(t),"STORAGE"==r&&this.auth.setAuth(t),this.changedAccessToken=t)}}const lt=(e,t,r)=>new ht(e,t,r),dt=lt("https://hapstamqjeneuqemeqdc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhhcHN0YW1xamVuZXVxZW1lcWRjIiwicm9sZSI6ImFub24iLCJpYXQiOjE2NjA0MTA2OTcsImV4cCI6MTk3NTk4NjY5N30.PIAizQUTawav59xeE_D3bgo-_5QmnYp9S8_dF0uyxL0");var ft=dt;const pt=ft;var vt=pt;vt.from("users").on("UPDATE",e=>{console.log(e.commit_timestamp)});var mt=Object(i["i"])({name:"App",data(){return{email:"",name:""}},methods:{async login(){await vt.auth.signIn({email:this.email});try{vt.from("users").insert({email:this.email,name:this.name})}catch(e){throw new Error(""+e)}}}}),gt=r("6b0d"),bt=r.n(gt);const yt=bt()(mt,[["render",o]]);t["default"]=yt},c04e:function(e,t,r){var n=r("c65b"),i=r("861d"),s=r("d9b5"),o=r("dc4a"),a=r("485a"),c=r("b622"),u=TypeError,h=c("toPrimitive");e.exports=function(e,t){if(!i(e)||s(e))return e;var r,c=o(e,h);if(c){if(void 0===t&&(t="default"),r=n(c,e,t),!i(r)||s(r))return r;throw u("Can't convert object to primitive value")}return void 0===t&&(t="number"),a(e,t)}},c430:function(e,t){e.exports=!1},c65b:function(e,t,r){var n=r("40d5"),i=Function.prototype.call;e.exports=n?i.bind(i):function(){return i.apply(i,arguments)}},c6b6:function(e,t,r){var n=r("e330"),i=n({}.toString),s=n("".slice);e.exports=function(e){return s(i(e),8,-1)}},c6cd:function(e,t,r){var n=r("da84"),i=r("6374"),s="__core-js_shared__",o=n[s]||i(s,{});e.exports=o},c7708:function(e,t,r){var n=r("e330"),i=Error,s=n("".replace),o=function(e){return String(i(e).stack)}("zxcasd"),a=/\n\s*at [^:]*:[^\n]*/,c=a.test(o);e.exports=function(e,t){if(c&&"string"==typeof e&&!i.prepareStackTrace)while(t--)e=s(e,a,"");return e}},ca84:function(e,t,r){var n=r("e330"),i=r("1a2d"),s=r("fc6a"),o=r("4d64").indexOf,a=r("d012"),c=n([].push);e.exports=function(e,t){var r,n=s(e),u=0,h=[];for(r in n)!i(a,r)&&i(n,r)&&c(h,r);while(t.length>u)i(n,r=t[u++])&&(~o(h,r)||c(h,r));return h}},cb2d:function(e,t,r){var n=r("1626"),i=r("9bf2"),s=r("13d2"),o=r("6374");e.exports=function(e,t,r,a){a||(a={});var c=a.enumerable,u=void 0!==a.name?a.name:t;if(n(r)&&s(r,u,a),a.global)c?e[t]=r:o(t,r);else{try{a.unsafe?e[t]&&(c=!0):delete e[t]}catch(h){}c?e[t]=r:i.f(e,t,{value:r,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return e}},cc12:function(e,t,r){var n=r("da84"),i=r("861d"),s=n.document,o=i(s)&&i(s.createElement);e.exports=function(e){return o?s.createElement(e):{}}},d012:function(e,t){e.exports={}},d039:function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},d066:function(e,t,r){var n=r("da84"),i=r("1626"),s=function(e){return i(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?s(n[e]):n[e]&&n[e][t]}},d1e7:function(e,t,r){"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,s=i&&!n.call({1:2},1);t.f=s?function(e){var t=i(this,e);return!!t&&t.enumerable}:n},d2bb:function(e,t,r){var n=r("e330"),i=r("825a"),s=r("3bbe");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{e=n(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),e(r,[]),t=r instanceof Array}catch(o){}return function(r,n){return i(r),s(n),t?e(r,n):r.__proto__=n,r}}():void 0)},d9b5:function(e,t,r){var n=r("d066"),i=r("1626"),s=r("3a9b"),o=r("fdbf"),a=Object;e.exports=o?function(e){return"symbol"==typeof e}:function(e){var t=n("Symbol");return i(t)&&s(t.prototype,a(e))}},d9e2:function(e,t,r){var n=r("23e7"),i=r("da84"),s=r("2ba4"),o=r("e5cb"),a="WebAssembly",c=i[a],u=7!==Error("e",{cause:7}).cause,h=function(e,t){var r={};r[e]=o(e,t,u),n({global:!0,constructor:!0,arity:1,forced:u},r)},l=function(e,t){if(c&&c[e]){var r={};r[e]=o(a+"."+e,t,u),n({target:a,stat:!0,constructor:!0,arity:1,forced:u},r)}};h("Error",(function(e){return function(t){return s(e,this,arguments)}})),h("EvalError",(function(e){return function(t){return s(e,this,arguments)}})),h("RangeError",(function(e){return function(t){return s(e,this,arguments)}})),h("ReferenceError",(function(e){return function(t){return s(e,this,arguments)}})),h("SyntaxError",(function(e){return function(t){return s(e,this,arguments)}})),h("TypeError",(function(e){return function(t){return s(e,this,arguments)}})),h("URIError",(function(e){return function(t){return s(e,this,arguments)}})),l("CompileError",(function(e){return function(t){return s(e,this,arguments)}})),l("LinkError",(function(e){return function(t){return s(e,this,arguments)}})),l("RuntimeError",(function(e){return function(t){return s(e,this,arguments)}}))},da84:function(e,t,r){(function(t){var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof t&&t)||function(){return this}()||Function("return this")()}).call(this,r("c8ba"))},dc4a:function(e,t,r){var n=r("59ed");e.exports=function(e,t){var r=e[t];return null==r?void 0:n(r)}},e330:function(e,t,r){var n=r("40d5"),i=Function.prototype,s=i.bind,o=i.call,a=n&&s.bind(o,o);e.exports=n?function(e){return e&&a(e)}:function(e){return e&&function(){return o.apply(e,arguments)}}},e391:function(e,t,r){var n=r("577e");e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:n(e)}},e5cb:function(e,t,r){"use strict";var n=r("d066"),i=r("1a2d"),s=r("9112"),o=r("3a9b"),a=r("d2bb"),c=r("e893"),u=r("aeb0"),h=r("7156"),l=r("e391"),d=r("ab36"),f=r("c7708"),p=r("b980"),v=r("83ab"),m=r("c430");e.exports=function(e,t,r,g){var b="stackTraceLimit",y=g?2:1,_=e.split("."),w=_[_.length-1],k=n.apply(null,_);if(k){var S=k.prototype;if(!m&&i(S,"cause")&&delete S.cause,!r)return k;var T=n("Error"),O=t((function(e,t){var r=l(g?t:e,void 0),n=g?new k(e):new k;return void 0!==r&&s(n,"message",r),p&&s(n,"stack",f(n.stack,2)),this&&o(S,this)&&h(n,this,O),arguments.length>y&&d(n,arguments[y]),n}));if(O.prototype=S,"Error"!==w?a?a(O,T):c(O,T,{name:!0}):v&&b in k&&(u(O,k,b),u(O,k,"prepareStackTrace")),c(O,k),!m)try{S.name!==w&&s(S,"name",w),S.constructor=O}catch(E){}return O}}},e893:function(e,t,r){var n=r("1a2d"),i=r("56ef"),s=r("06cf"),o=r("9bf2");e.exports=function(e,t,r){for(var a=i(t),c=o.f,u=s.f,h=0;h<a.length;h++){var l=a[h];n(e,l)||r&&n(r,l)||c(e,l,u(t,l))}}},f5df:function(e,t,r){var n=r("00ee"),i=r("1626"),s=r("c6b6"),o=r("b622"),a=o("toStringTag"),c=Object,u="Arguments"==s(function(){return arguments}()),h=function(e,t){try{return e[t]}catch(r){}};e.exports=n?s:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=h(t=c(e),a))?r:u?s(t):"Object"==(n=s(t))&&i(t.callee)?"Arguments":n}},f772:function(e,t,r){var n=r("5692"),i=r("90e3"),s=n("keys");e.exports=function(e){return s[e]||(s[e]=i(e))}},fc6a:function(e,t,r){var n=r("44ad"),i=r("1d80");e.exports=function(e){return n(i(e))}},fdbf:function(e,t,r){var n=r("4930");e.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator}}]);
//# sourceMappingURL=chunk-17797c20.82209c13.js.map